(window.webpackJsonp=window.webpackJsonp||[]).push([[214],{581:function(e,r,t){"use strict";t.r(r);var a=t(48),s=Object(a.a)({},function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"デバッグ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#デバッグ","aria-hidden":"true"}},[e._v("#")]),e._v(" デバッグ")]),e._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("p",[e._v("このページは、"),t("code",[e._v("support/apply-nextjs-2")]),e._v(" ブランチでの開発用に書かれています。")])]),e._v(" "),t("p",[e._v("クライアントサイドコードとサーバーサイドコードのそれぞれに対して、開発で利用できるデバッグの手段および手順を紹介します。")]),e._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#ブラウザーによるデバッグ"}},[e._v("ブラウザーによるデバッグ")])]),t("li",[t("a",{attrs:{href:"#vscode-によるリモートデバッグ"}},[e._v("VSCode によるリモートデバッグ")])])])]),t("p"),e._v(" "),t("h2",{attrs:{id:"ブラウザーによるデバッグ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ブラウザーによるデバッグ","aria-hidden":"true"}},[e._v("#")]),e._v(" ブラウザーによるデバッグ")]),e._v(" "),t("p",[e._v("ブラウザーの機能を使うことによって、JS / React のクライアントサイドコードをデバッグできます。")]),e._v(" "),t("h3",{attrs:{id:"chrome"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chrome","aria-hidden":"true"}},[e._v("#")]),e._v(" Chrome")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("yarn dev")]),e._v(" で開発用サーバーを起動します。")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://developer.chrome.com/docs/devtools/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Chrome DevTools"),t("OutboundLink")],1),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://developer.chrome.com/docs/devtools/javascript/sources/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Sources panel"),t("OutboundLink")],1),e._v(" を使ってデバッグできます。")]),e._v(" "),t("li",[t("code",[e._v("Ctrl + P")]),e._v(" で TypeScript ファイルを開く場合は、"),t("code",[e._v("webpack://_N_E/")]),e._v(" 配下のファイルを選んでください。")])])])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/assets/images/debugging-chrome-source-panel.png"),alt:"Chrome source panel"}}),e._v(" "),t("h3",{attrs:{id:"firefox"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#firefox","aria-hidden":"true"}},[e._v("#")]),e._v(" Firefox")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("yarn dev")]),e._v(" で開発用サーバーを起動します。")]),e._v(" "),t("li",[t("a",{attrs:{href:"https://developer.mozilla.org/ja/docs/Learn/Common_questions/What_are_browser_developer_tools",target:"_blank",rel:"noopener noreferrer"}},[e._v("Firefox 開発者ツール"),t("OutboundLink")],1),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://firefox-source-docs.mozilla.org/devtools-user/debugger/",target:"_blank",rel:"noopener noreferrer"}},[e._v("JavaScript Debugger"),t("OutboundLink")],1),e._v(" を使ってデバッグできます。")]),e._v(" "),t("li",[t("code",[e._v("Ctrl + P")]),e._v(" で TypeScript ファイルを開く場合は、少しわかりにくいですが同名のファイルのうち末尾に "),t("code",[e._v("?xxxx")]),e._v(" といったランダムな接尾辞を持つファイルがオリジナルソースです。\n"),t("ul",[t("li",[e._v("或いは左カラムのソースファイルツリーから "),t("code",[e._v("Webpack")]),e._v(" 配下のファイルを選んでください。")])])])])])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/assets/images/debugging-firefox-debugger-panel.png"),alt:"Firefox debugger panel"}}),e._v(" "),t("h2",{attrs:{id:"vscode-によるリモートデバッグ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vscode-によるリモートデバッグ","aria-hidden":"true"}},[e._v("#")]),e._v(" VSCode によるリモートデバッグ")]),e._v(" "),t("p",[e._v("VSCodeでは、クライアントサイドコードとサーバサイドコードの両方をデバッグできます。")]),e._v(" "),t("h3",{attrs:{id:"クライアントサイドコードのデバッグ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#クライアントサイドコードのデバッグ","aria-hidden":"true"}},[e._v("#")]),e._v(" クライアントサイドコードのデバッグ")]),e._v(" "),t("p",[e._v("「"),t("a",{attrs:{href:"#%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%83%BC%E3%81%AB%E3%82%88%E3%82%8B%E3%83%87%E3%83%90%E3%83%83%E3%82%B0"}},[e._v("ブラウザーによるデバッグ")]),e._v("」で紹介した機能と同等です。"),t("br"),e._v("\nVSCode 上で編集しているソースコードに対してブレークポイントを設定できます。")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Chrome")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("yarn dev")]),e._v(" で開発用サーバーを起動します。")]),e._v(" "),t("li",[e._v("Run and Debug パネルから「Debug: Chrome」を選択します。")])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/assets/images/debugging-vscode-chrome-debugger.png"),alt:"VSCode Chrome debugger"}})]),e._v(" "),t("li",[t("p",[e._v("Firefox")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("yarn dev")]),e._v(" で開発用サーバーを起動します。")]),e._v(" "),t("li",[e._v("Run and Debug パネルから「Debug: Firefox」を選択します。")])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/assets/images/debugging-vscode-firefox-debugger.png"),alt:"VSCode Firefox debugger"}})])]),e._v(" "),t("h3",{attrs:{id:"サーバーサイドコードのデバッグ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#サーバーサイドコードのデバッグ","aria-hidden":"true"}},[e._v("#")]),e._v(" サーバーサイドコードのデバッグ")]),e._v(" "),t("p",[e._v("2種類の方法で開発用サーバーにデバッガーを attach できます。")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("開発用サーバー起動後にデバッガーを attach する")]),e._v(" "),t("ul",[t("li",[t("p",[t("strong",[e._v("特徴: 高速かつ柔軟、開発中の任意のタイミングで attach / dettach できる")])])]),e._v(" "),t("li",[t("p",[e._v("attach 手順:")]),e._v(" "),t("ol",[t("li",[t("p",[e._v("予め "),t("code",[e._v("yarn dev")]),e._v(" で開発用サーバーを起動します。")]),e._v(" "),t("ul",[t("li",[e._v("Ports パネルで "),t("code",[e._v("9229")]),e._v(" ポートのフォワーディングが表示されていることを確認します。")])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/assets/images/debugging-portforwarding.png"),alt:"Portforwarding"}})]),e._v(" "),t("li",[t("p",[e._v("Run and Debug パネルから「Debug: Attach Debugger to Server」を選択します。")])])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/assets/images/debugging-vscode-attach-debugger-to-server-debugger.png"),alt:"VSCode Attach Debugger to Server debugger"}})])])]),e._v(" "),t("li",[t("p",[e._v("デバッガーを attach したサーバーを起動する")]),e._v(" "),t("ul",[t("li",[t("p",[t("strong",[e._v("特徴: サーバー起動時の処理に対してもブレークポイントを設定できる")])])]),e._v(" "),t("li",[t("p",[e._v("attach 手順:")]),e._v(" "),t("ol",[t("li",[e._v("Run and Debug パネルから「Debug: Server」を選択します。")])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/assets/images/debugging-vscode-server-debugger.png"),alt:"VSCode Server debugger"}})])])])]),e._v(" "),t("p",[e._v("attach が正常に完了すると、VSCode のステータスバーの色がオレンジになります。この状態で任意のサーバーサイドコードにブレークポイントを設定してデバッグできます。")]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("Unbound breakpoint への対処")]),e._v(" "),t("p",[e._v("ブレークポイントを設定しても Unbound breakpoint になってしまう場合は、以下を確認してください。")]),e._v(" "),t("ul",[t("li",[e._v("Express のコードから import / require されていることを確認してください。")]),e._v(" "),t("li",[t("code",[e._v("packages/app/src/pages")]),e._v(" 配下のファイルの内、拡張子が "),t("code",[e._v("*.page.ts")]),e._v(" のファイルは "),t("a",{attrs:{href:"https://nextjs.org/docs/basic-features/pages",target:"_blank",rel:"noopener noreferrer"}},[e._v("Next.js の Pages Component"),t("OutboundLink")],1),e._v(" です。\nこれらのファイルは開発用サーバー起動直後ではまだコンパイルされていないため、ブレークポイントを設定できません。ブラウザから当該ページへアクセスするなどしてコンパイルしてください。")]),e._v(" "),t("li",[e._v("設定したブレークポイントが有効化されたり無効化(Unbound breakpoint)されたりして不安定な場合は、Node.js プロセスへの "),t("code",[e._v("--nolazy")]),e._v(" オプションの設定を検討してください。"),t("br"),e._v("\n参考: "),t("a",{attrs:{href:"https://code.visualstudio.com/docs/nodejs/nodejs-debugging#_breakpoint-validation",target:"_blank",rel:"noopener noreferrer"}},[e._v("Breakpoint validation"),t("OutboundLink")],1)])])])])},[],!1,null,null,null);r.default=s.exports}}]);